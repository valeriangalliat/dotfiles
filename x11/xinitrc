#
# ~/.xinitrc
#

xrdb -merge "$DOTFILES/x11/Xresources"

if [ -f ~/.Xresources ]; then
    xrdb -merge ~/.Xresources
fi

# Use Mac layout
setxkbmap -variant mac

# Load custom keyboard map (invert left Alt and Ctrl)
xmodmap "$DOTFILES/x11/xmodmaprc"

if [ -f ~/.xmodmaprc ]; then
    xmodmap ~/.xmodmaprc
fi

# Set keyboard repeat delay to 220 instead of default of 660
xset r rate 220

# Auto lock on screen sleep, suspend, hibernate
if command -v xss-lock block; then
    xss-lock -l block &
fi

#
# Auto suspend after 10 minutes of inactivity.
#
# I need to use `xautolock` for this instead of relying on `IdleAction` in
# `/etc/systemd/logind.conf` because the latter doesn't work without a display
# manager. Since I use `startx` without display manager, the idle status is not
# reported to logind for some reason and results in systematic suspend even
# when active.
#
# The `-corners` options as configured below makes it that if the mouse is in
# any corner of the screen, the locker will not activate.
#
if command -v xautolock; then
  xautolock -detectsleep -time 10 -corners ---- -locker 'systemctl suspend' &
fi

# Execute Picom if available
if command -v picom; then
    picom &
fi

# Execute Redshift if available (Montreal)
if command -v redshift; then
    redshift -l 45.5017:-73.5673 &
fi

# Window manager
exec i3

# vim: ft=sh
